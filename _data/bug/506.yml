+p_xml: 'version="1.0" encoding="UTF-8" standalone="yes" '
+directive: DOCTYPE bugzilla SYSTEM "http://bugzilla.fieldtriptoolbox.org/page.cgi?id=bugzilla.dtd"
bugzilla:
  +@version: 4.4.1
  +@urlbase: http://bugzilla.fieldtriptoolbox.org/
  +@maintainer: r.oostenveld@donders.ru.nl
  bug:
    bug_id: "506"
    creation_ts: 2011-02-25 13:31:00 +0100
    short_desc: Suggestion for reading gdf events
    delta_ts: 2011-03-31 14:13:54 +0200
    reporter_accessible: "1"
    cclist_accessible: "1"
    classification_id: "1"
    classification: Unclassified
    product: FieldTrip
    component: fileio
    version: unspecified
    rep_platform: All
    op_sys: Mac OS
    bug_status: CLOSED
    resolution: FIXED
    bug_file_loc:
    status_whiteboard:
    keywords:
    priority: P1
    bug_severity: enhancement
    target_milestone: '---'
    everconfirmed: "1"
    reporter:
      +content: philipvandenbroek
      +@name: Philip van den Broek
    assigned_to:
      +content: r.oostenveld
      +@name: Robert Oostenveld
    cc: j.schoffelen
    comment_sort_order: oldest_to_newest
    long_desc:
      - +@isprivate: "0"
        commentid: "1513"
        comment_count: "0"
        attachid: "26"
        who:
          +content: philipvandenbroek
          +@name: Philip van den Broek
        bug_when: 2011-02-25 13:31:14 +0100
        thetext: "Created attachment 26\nsolution to reading events from biosem2ft generated gdf-file\n\nReading events from file formats that do not have a fixed representation of events might be achieved by allowing users to write their own event reading function (event = eventfun(filename, cfg)). The ft_read_event function should then accept eventfun as an input argument.\n\nI included a rough but working example of how to readout events from a gdf-file generated by biosemi2ft. The code below should replace the code in ft_read_event. The attached file shows the example eventfun function read_biosig_biosemi_events. \n\nAllowing the user to specify customized event reading functions, might also be made an option to all other file formats.\n----------------------------------\n\n\tcase {'biosig', 'gdf'}\n%Ph: allow users to specify their own read_event function (eventfun)?\n% NOTE: FIXED FUNCTION UNTIL A GENERALLY ACCEPTED SOLUTION IS FOUND !!!\n% Should become something like: cfg.eventfun.gdf = 'read_biosig_biosemi_events'??\n% and generally applicable to all other file formats, i.e., take default or\n% user eventfun if specified\n\t\teventfun = 'read_biosig_biosemi_events';\n\t\tif ~isempty(eventfun) && ~isempty(which(eventfun))\n\t\t\tif isempty(hdr)\n\t\t\t\thdr = ft_read_header(filename);\n\t\t\tend\n\t\t\tcfg.eventformat\t\t= eventformat;\n\t\t\tcfg.hdr\t\t\t\t\t= hdr;\n\t\t\tcfg.detectflank\t\t= detectflank;\n\t\t\tcfg.trigshift\t\t\t= trigshift;\n\t\t\tcfg.trigindx\t\t\t= trigindx;\n\t\t\tcfg.headerformat\t\t= headerformat;\n\t\t\tcfg.dataformat\t\t\t= dataformat;\n\t\t\t\n\t\t\tcfg.flt_type\t\t\t= flt_type;\n\t\t\tcfg.flt_value\t\t\t= flt_value;\n\t\t\tcfg.flt_minsample\t\t= flt_minsample;\n\t\t\tcfg.flt_maxsample\t\t= flt_maxsample;\n\t\t\tcfg.flt_mintimestamp = flt_mintimestamp;\n\t\t\tcfg.flt_maxtimestamp = flt_maxtimestamp;\n\t\t\tcfg.flt_minnumber\t\t= flt_minnumber;\n\t\t\tcfg.flt_maxnumber\t\t= flt_maxnumber;\n\t\t\t\n\t\t\t% read events via user specified function\n\t\t\tevent = feval(eventfun,filename,cfg);\n\t\telse\n\t\t\t% FIXME it would be nice to figure out how sopen/sread return events\n\t\t\t% for all possible fileformats that can be processed with biosig\n\t\t\twarning('BIOSIG does not have a consistent event representation, skipping events')\n\t\t\tevent = [];\n\t\tend"
      - +@isprivate: "0"
        commentid: "1629"
        comment_count: "1"
        who:
          +content: r.oostenveld
          +@name: Robert Oostenveld
        bug_when: 2011-03-16 22:52:03 +0100
        thetext: "Het probleem en de oplossing is specifiek voor de combinatie GDF met een biosemi versterker. Het is niet een algemeen biosig probleem, dus hoeft het ook niet voor biosig opgelost te worden.\n\nmijn voorstel is om een read_gdf_event te maken die\n1) checkt dat een STATUS kanaal aanwezig is\n2) ft_read_data aanroept om het STATUS kanaal te lezen (dat gebruikt dan automatisch biosig)\n3) de flank detectie en bitshifts doet zoals in je code\n\nvervolgens in ft_read_event\n  case 'gdf'\n    % this will read the STATUS channel, which indicates that it is recorded on a biosemi amplifier\n  % it will give a warning if no STATUS channel is present\n   event = read_gdf_event(filename)\n \n  case 'biosig'\n    % FIXME it would be nice to figure out how sopen/sread return events\n    % for all possible fileformats that can be processed with biosig\n    warning('BIOSIG does not have a consistent event representation, skipping events')\n    event = [];"
      - +@isprivate: "0"
        commentid: "1663"
        comment_count: "2"
        who:
          +content: philipvandenbroek
          +@name: Philip van den Broek
        bug_when: 2011-03-21 15:29:15 +0100
        thetext: |-
          In het geval van het neurosky thinkgear device hebben we idd geen STATUS kanaal. Als de warning een identifier krijgt kunnen we in het geval op voorhand bekend is dat er geen events te lezen zijn deze warning uitschakelen.

          Verder hebben we in het verleden de (achteraf onhandige) keuze gemaakt om het statuskanaal voor de biosemi amp. te splitsen in een stimulus en response kanaal. Hierdoor zitten we vwb uitlezen  van deze events met een compabiliteitsprobleem. Ik heb dat nu lokaal gewijzigd, maar is geen goede oplossing. Dat was o.a. ook de reden voor de suggestie om custom read_event functies toe te staan. Heb je hier een goede oplossing voor?
      - +@isprivate: "0"
        commentid: "1697"
        comment_count: "3"
        who:
          +content: r.oostenveld
          +@name: Robert Oostenveld
        bug_when: 2011-03-29 14:05:39 +0200
        thetext: |-
          manzana> svn commit
          Sending        fileio/ft_read_event.m
          Sending        fileio/ft_read_header.m
          Sending        fileio/private/read_trigger.m
          Transmitting file data ...
          Committed revision 3241.
      - +@isprivate: "0"
        commentid: "1723"
        comment_count: "4"
        who:
          +content: r.oostenveld
          +@name: Robert Oostenveld
        bug_when: 2011-03-31 14:13:54 +0200
        thetext: changed the status of most recently resolved/fixed bugs into "CLOSED"
    attachment:
      +@isobsolete: "0"
      +@ispatch: "0"
      +@isprivate: "0"
      attachid: "26"
      date: 2011-02-25 13:31:00 +0100
      delta_ts: 2011-02-25 13:31:14 +0100
      desc: solution to reading events from biosem2ft generated gdf-file
      filename: read_biosig_biosemi_events.m
      type: application/octet-stream
      size: "5216"
      attacher:
        +content: philipvandenbroek
        +@name: Philip van den Broek
      data: REMOVED
